import{d as h,c as r,a as s,n as I,t as a,o as n,_ as m,b,r as d,u as D,e as B,F as g,f as _,g as C,h as R,w as k,i as L,j as F}from"./index-DEc4n1eP.js";const N={class:"course-info"},S={class:"details"},V={class:"meta"},j={class:"department"},x={class:"credit"},z={class:"rating"},E=h({__name:"CourseInfo",props:{course:{}},setup(i){return(e,t)=>(n(),r("div",N,[s("div",{class:"cover",style:I({backgroundImage:`url(${e.course.cover_url||"/default-course.jpg"})`})},null,4),s("div",S,[s("h1",null,a(e.course.name),1),s("div",V,[s("span",j,a(e.course.department),1),s("span",x,a(e.course.credit)+"学分",1),s("span",z,"平均评分: "+a(e.course.avg_rating?.toFixed(1)||"暂无"),1)])])]))}}),M=m(E,[["__scopeId","data-v-7488874d"]]),P={class:"review-card"},T={class:"header"},U={class:"user"},q={class:"date"},A={class:"ratings"},G={class:"rating-item"},H={class:"value"},J={class:"rating-item"},K={class:"value"},O={class:"rating-item"},Q={class:"value"},W={class:"content"},X=h({__name:"ReviewCard",props:{review:{}},setup(i){return(e,t)=>(n(),r("div",P,[s("div",T,[s("span",U,a(e.review.user_name||"匿名用户"),1),s("span",q,a(new Date(e.review.created_at).toLocaleDateString()),1)]),s("div",A,[s("div",G,[t[0]||(t[0]=s("span",null,"难度: ",-1)),s("span",H,a(e.review.difficulty?.toFixed(1)||"-"),1)]),s("div",J,[t[1]||(t[1]=s("span",null,"给分: ",-1)),s("span",K,a(e.review.grading?.toFixed(1)||"-"),1)]),s("div",O,[t[2]||(t[2]=s("span",null,"收获: ",-1)),s("span",Q,a(e.review.harvest?.toFixed(1)||"-"),1)])]),s("div",W,a(e.review.content),1)]))}}),Y=m(X,[["__scopeId","data-v-eafd700e"]]),f=b.create({baseURL:"http://localhost:5000"}),Z=async i=>(await f.get(`/api/courses/${i}`)).data,ss=async(i,e=10,t=0)=>(await f.get(`/api/courses/${i}/reviews`,{params:{limit:e,offset:t}})).data,es=async i=>(await f.get(`/api/courses/${i}/similar`)).data,ts={class:"course-detail"},as={key:0},os={class:"main-content"},ns={class:"left-section"},rs={class:"rating-chart"},is={class:"rating-chart"},ls={class:"reviews-section"},cs={class:"right-section"},ds={class:"similar-courses"},us={key:2},_s=h({__name:"CourseDetail",setup(i){const e=D(),t=d(Number(e.params.id)),c=d(null),w=d([]),$=d([]),v=d(!1);return B(async()=>{v.value=!0;try{const[u,o,p]=await Promise.all([Z(t.value),es(t.value),ss(t.value)]);c.value=u,w.value=o.courses||[],$.value=p.reviews||[]}catch(u){console.error("Failed to fetch course data:",u)}finally{v.value=!1}}),(u,o)=>{const p=C("RatingRadar"),y=C("router-link");return n(),r("div",ts,[v.value?(n(),r("div",as,"加载中...")):c.value?(n(),r(g,{key:1},[_(M,{course:c.value},null,8,["course"]),s("div",os,[s("div",ns,[s("div",rs,[o[1]||(o[1]=s("h3",null,"课程评分",-1)),s("div",is,[o[0]||(o[0]=s("h3",null,"课程评分",-1)),_(p,{stats:{difficulty:c.value.avg_difficulty,grading:c.value.avg_grading,harvest:c.value.avg_harvest}},null,8,["stats"])])]),s("div",ls,[o[2]||(o[2]=s("h3",null,"课程评价",-1)),(n(!0),r(g,null,R($.value,l=>(n(),L(Y,{key:l.id,review:l},null,8,["review"]))),128))])]),s("div",cs,[s("div",ds,[o[3]||(o[3]=s("h3",null,"相似课程",-1)),(n(!0),r(g,null,R(w.value,l=>(n(),r("div",{key:l.id,class:"similar-course"},[_(y,{to:`/course/${l.id}`},{default:k(()=>[F(a(l.name)+" ("+a(l.department)+") ",1)]),_:2},1032,["to"]),s("span",null,"评分: "+a(l.avg_rating.toFixed(1)),1)]))),128))])])]),_(y,{to:"/review/publish",class:"floating-button"},{default:k(()=>o[4]||(o[4]=[F(" 写评价 ")])),_:1,__:[4]})],64)):(n(),r("div",us,"课程不存在"))])}}}),ps=m(_s,[["__scopeId","data-v-1f3a12d2"]]);export{ps as default};
