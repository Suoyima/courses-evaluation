import{b as h,d as k,r,e as x,c as l,a,k as i,v as g,l as R,m as f,F as _,h as y,t as w,i as C,C as S,o as n,_ as V}from"./index-DEc4n1eP.js";const b=h.create({baseURL:"http://localhost:5000"}),U=async()=>(await b.get("/api/search/filters")).data,B=async v=>(await b.get("/api/courses/search",{params:v})).data,F={class:"search-view"},D={class:"search-header"},L={class:"search-container"},M={class:"filter-panel"},I={class:"filter-group"},K=["value"],E={class:"filter-group"},N={class:"range-inputs"},O={class:"filter-group"},Q=["value"],T={class:"results-panel"},j={key:0,class:"loading"},q={key:1,class:"no-results"},z={key:2,class:"results-grid"},A=k({__name:"SearchView",setup(v){const u=r(""),s=r({department:"",minRating:0,maxRating:5,credit:0}),p=r([]),c=r({departments:[],credits:[]}),m=r(!1),d=async()=>{m.value=!0;try{const o={keyword:u.value,department:s.value.department,min_rating:s.value.minRating,max_rating:s.value.maxRating,credit:s.value.credit||void 0},t=await B(o);p.value=t.courses.map(e=>({...e,review:{id:0,course_id:e.id,course_name:e.name,rating:e.avg_rating,content:"",created_at:new Date().toISOString()}}))}catch(o){console.error("搜索失败:",o)}finally{m.value=!1}};return x(async()=>{const o=await U();c.value=o,await d()}),(o,t)=>(n(),l("div",F,[a("div",D,[i(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),type:"text",placeholder:"搜索课程...",onKeyup:R(d,["enter"])},null,544),[[g,u.value]]),a("button",{onClick:d},"搜索")]),a("div",L,[a("div",M,[t[11]||(t[11]=a("h3",null,"筛选条件",-1)),a("div",I,[t[6]||(t[6]=a("label",null,"院系:",-1)),i(a("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.value.department=e)},[t[5]||(t[5]=a("option",{value:""},"全部院系",-1)),(n(!0),l(_,null,y(c.value.departments,e=>(n(),l("option",{key:e,value:e},w(e),9,K))),128))],512),[[f,s.value.department]])]),a("div",E,[t[8]||(t[8]=a("label",null,"评分范围:",-1)),a("div",N,[i(a("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.value.minRating=e),type:"number",min:"0",max:"5",step:"0.1"},null,512),[[g,s.value.minRating,void 0,{number:!0}]]),t[7]||(t[7]=a("span",null,"至",-1)),i(a("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.value.maxRating=e),type:"number",min:"0",max:"5",step:"0.1"},null,512),[[g,s.value.maxRating,void 0,{number:!0}]])])]),a("div",O,[t[10]||(t[10]=a("label",null,"学分:",-1)),i(a("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>s.value.credit=e)},[t[9]||(t[9]=a("option",{value:0},"全部",-1)),(n(!0),l(_,null,y(c.value.credits,e=>(n(),l("option",{key:e,value:e},w(e)+"学分 ",9,Q))),128))],512),[[f,s.value.credit,void 0,{number:!0}]])]),a("button",{class:"apply-btn",onClick:d},"应用筛选")]),a("div",T,[m.value?(n(),l("div",j,"加载中...")):p.value.length===0?(n(),l("div",q,"没有找到匹配的课程")):(n(),l("div",z,[(n(!0),l(_,null,y(p.value,e=>(n(),C(S,{key:e.id,course:{id:e.id,name:e.name,rating:e.avg_rating},review:e.review},null,8,["course","review"]))),128))]))])])]))}}),H=V(A,[["__scopeId","data-v-6bc8af7a"]]);export{H as default};
